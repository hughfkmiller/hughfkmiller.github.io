---
title: "BYU Baseball"
format: html
editor: visual
warning: false
code-fold: true
keep-md: true
---

## Which Utah School Produces the Most Success Pro Baseball Players?

```{r}
library(tidyverse)
library(Lahman)
library(priceR)

names <- select(People, c("playerID", "nameFirst", "nameLast"))
schoolnames <- select(Schools, c("schoolID", "name_full", "state"))

data <- left_join(CollegePlaying, names, by="playerID")
data2 <- left_join(data, schoolnames, by="schoolID")
data3 <- inner_join(data2, Salaries, by="playerID")

names(data3)[3] = "School_year"
names(data3)[8] = "Pro_year"

utah_player <- data3 %>% 
  filter(state=="UT") %>% 
  unite("full_name", nameFirst, nameLast, sep=" ")

View(utah_player)

adjust_for_inflation(price = utah_player$salary, from_date = utah_player$Pro_year, country = "US", to_date = 2021)


```

```{r}
averages <- utah_player %>% 
  group_by(Pro_year, name_full) %>% 
  summarise(mean=mean(salary))


salarychart <- ggplot(data=averages) +
  geom_line(aes(x=Pro_year, y=mean, color=name_full))+
  labs(title="Average MLB Salary by Season and School", x="Year", y="Average Salary (in 2021 U.S. Dollars)", color="School") +
  theme_bw()

salarychart

```

```{r}
#|length:10
#|width:14

# get totals of all players career salaries
topplayers <- utah_player %>% 
  group_by(full_name) %>% 
  summarise(total=sum(salary))

# narrow down to just the top 10 players with highest career earnings
topplayers2 <- topplayers %>% 
  slice_max(total, n=10, with_ties=FALSE)

# do an inner join with the full player data to get their school names
utah_player2 <- select(utah_player, c("full_name", "name_full"))
topplayers3 <- inner_join(utah_player2, topplayers2, by="full_name")

# drop  based on name
topplayers4 <- topplayers3[!duplicated(topplayers3$full_name), ]
View(topplayers4)


playerschart <- ggplot(data=topplayers4) +
  geom_bar(stat="identity", aes(x=reorder(full_name, -total), y=total/1000000, fill=name_full)) +
  theme_classic() +
  theme(axis.text.x=element_text(angle=45, hjust=1)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = 3)) +
  labs(title="Top 10 Highest Career Earnings for Utah MLB Players", subtitle= "Adjusted for inflation to 2021 U.S. Dollars", x="", y="Total Career Earnings (in Millions)", fill="School")
  

playerschart


```

The two plots above give us some insight into which Utah college has produced the most successful baseball players. The first plot is a line graph that plots the average professional salary of players for a certain school for each season. Prior to 2000, BYU appears to be the only school that had alumni in the major leagues. After 2000, players from other schools begin to show up, but BYU continued to dominate in terms of average salary. Dixie State was the only real competitor in this metric from 2000 and on.

The second plot shows the top individual players from this time period in terms of total career earnings (adjusted to inflation). Each player is colored according to their school. We see BYU highly represented in the plot, as six of the top 10 players went to school there. This shows that players from BYU were highly paid and also probably spent more time in the MLB than players who went to other schools. We can conclude that BYU is the most successful Utah school when it comes to producing successful professional baseball players.
